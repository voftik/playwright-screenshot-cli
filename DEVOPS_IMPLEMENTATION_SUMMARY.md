# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö DevOps –ø—Ä–∞–∫—Ç–∏–∫ –¥–ª—è Playwright Screenshotter

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Winston
- **–§–∞–π–ª**: `lib/logger.js`
- **–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**:
  - JSON —Ñ–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤ –¥–ª—è production
  - –¶–≤–µ—Ç–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è development
  - –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ (–º–∞–∫—Å–∏–º—É–º 10MB –Ω–∞ —Ñ–∞–π–ª, 5 —Ñ–∞–π–ª–æ–≤)
  - –û—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –æ—à–∏–±–æ–∫
  - –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: `request`, `screenshot`, `externalIp`, `security`, `performance`

### 2. –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å graceful shutdown
- **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤**: `web-server.js`
- **–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**:
  - Graceful shutdown –ø–æ SIGTERM/SIGINT
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ unhandled rejections
  - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π —Ç–∞–π–º–∞—É—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —á–µ—Ä–µ–∑ `SHUTDOWN_TIMEOUT`

### 3. Health check endpoint
- **Endpoint**: `GET /health`
- **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
  - –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞ (UP/DOWN)
  - –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã (uptime)
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ (RSS, heap)
  - –¢–µ–∫—É—â–µ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
  - –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞

### 4. –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (Prometheus)
- **–§–∞–π–ª**: `lib/metrics.js`
- **Endpoint**: `GET /metrics`
- **–ú–µ—Ç—Ä–∏–∫–∏**:
  - HTTP –∑–∞–ø—Ä–æ—Å—ã (–ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Å—á–µ—Ç—á–∏–∫–∏)
  - –û–ø–µ—Ä–∞—Ü–∏–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤
  - –ü—Ä–æ–≤–µ—Ä–∫–∏ –≤–Ω–µ—à–Ω–µ–≥–æ IP
  - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ Node.js (–ø–∞–º—è—Ç—å, CPU, etc.)

### 5. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **–§–∞–π–ª**: `.env`
- **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**:
  - `PORT` - –ø–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞
  - `NODE_ENV` - –æ–∫—Ä—É–∂–µ–Ω–∏–µ
  - `LOG_LEVEL` - —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
  - `LOG_FILE` - –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –ª–æ–≥–æ–≤
  - `SHUTDOWN_TIMEOUT` - —Ç–∞–π–º–∞—É—Ç graceful shutdown
  - `RESULTS_DIR` - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
  - –ò –¥—Ä—É–≥–∏–µ...

### 6. –£–ª—É—á—à–µ–Ω–Ω—ã–π UI/UX
- **–®–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä**: EJS
- **–§–∞–π–ª—ã**:
  - `templates/layout.ejs` - –æ—Å–Ω–æ–≤–Ω–æ–π –º–∞–∫–µ—Ç
  - `templates/content.ejs` - –∫–æ–Ω—Ç–µ–Ω—Ç –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  - `templates/view-session.ejs` - –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–µ—Å—Å–∏–∏
  - `lib/templateRenderer.js` - —Ä–µ–Ω–¥–µ—Ä–µ—Ä —à–∞–±–ª–æ–Ω–æ–≤

#### UI —É–ª—É—á—à–µ–Ω–∏—è:
- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ CSS —Å—Ç–∏–ª–∏
- –õ–∞–π—Ç–±–æ–∫—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –¢–∞–±–ª–∏—Ü–∞ —Å–µ—Å—Å–∏–π —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- Responsive –¥–∏–∑–∞–π–Ω

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
npm start
# –∏–ª–∏
node web-server.js
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ endpoints

#### DevOps endpoints:
- `GET /health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `GET /metrics` - –º–µ—Ç—Ä–∏–∫–∏ Prometheus

#### –û—Å–Ω–æ–≤–Ω—ã–µ endpoints:
- `GET /` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å dashboard
- `GET /view/:domain/:session` - –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–µ—Å—Å–∏–∏
- `GET /static/*` - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
- `GET /api/external-ip` - –≤–Ω–µ—à–Ω–∏–π IP
- `GET /api/config` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Å–Ω–æ–≤–Ω—ã—Ö –ª–æ–≥–æ–≤
tail -f logs/app.log

# –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—à–∏–±–æ–∫
tail -f logs/error.log

# –ß–µ—Ä–µ–∑ npm script
npm run logs
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Prometheus –º–µ—Ç—Ä–∏–∫–∏
–°–µ—Ä–≤–µ—Ä —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Prometheus –Ω–∞ `/metrics`:
- `http_request_duration_ms` - –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- `http_requests_total` - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- `screenshots_total` - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤
- `screenshot_duration_ms` - –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π —Å–∫—Ä–∏–Ω—à–æ—Ç–∞
- `external_ip_checks_total` - –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–Ω–µ—à–Ω–µ–≥–æ IP
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ Node.js

### Health check
Endpoint `/health` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ.

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —á–µ—Ä–µ–∑ —Ñ–∞–π–ª `.env`:

```env
PORT=9000
NODE_ENV=development
LOG_LEVEL=info
LOG_FILE=./logs/app.log
SHUTDOWN_TIMEOUT=30000
RESULTS_DIR=./results
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º DevOps –ø—Ä–∞–∫—Ç–∏–∫–∞–º:
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ Graceful shutdown
- ‚úÖ Health checks
- ‚úÖ Metrics –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –¥–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.
